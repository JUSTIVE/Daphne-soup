# 합성

## 2.1 합성

프로그래밍은 합성에 관한 것이다. 
> 분해될 수 없는 것들에 대해서는 맗하지 않아야 한다.
>  - 비트겐슈타인

이는 금지하는 것이 아니라, 사실에 대한 선언이다. 공부하고, 이해하고, 설명하는 모든 것들은 분해의 과정이다. 그리고 우리의 언어가 이를 투영한다.

대상과 화살표의 단어를 만든 이유는 합성의 개념을 정확하게 표현하기 위함이다.

f: a->b, g: b->c 가 있을 때, f 와 g 를 합성하는 함수는 수학에서 다음과 같이 표기할 수 있다.

$$ h = g \circ f $$

우리는 이를 "h is equal to g after f"라고 읽는다. 합성의 순서가 거꾸로처럼 보일 수 있지만, 이는 우리가 함수의 인자를 오른쪽에 받는 것으로 생각하기 때문이다. 하스켈에서는 원을 .으로 대체한다.

$$ h = g . f $$

이는 모든 프로그램을 요약한 것이다. h를 수행하기 위해, 우리는 더 작은 문제 f를 수행하고, 그 결과를 g로 수행하는 것을 한다. 우리가 g를 $ j \circ k $ 로 분해할 수 있다고 한다면,

$$ h = (j \circ k) \circ f = j \circ (k \circ f) $$

과 같이 쓸 수 있다. 이 합성은 결합법칙을 만족한다.
합성은 전합성과 후합성의 원천이다. 화살표 f가 화살표 h에 후합성된다면, 이는 $ f \circ h $ 인 화살표를 만든다. 물론, f는 f의 원천을 대상으로 하는 화살표만들 후합성할 수 있다.
f에 대한 후합성은 $(f \circ - )$ 와 같이 표기하며, h의 자리에 구멍을 만든다. 노자도 비어있는 것이 유용하다고 했다(고(故)로 유지이위리(有之以爲利)는 무지이위용(無之以爲用)이라 : 이익이 되는 것은 없음이 쓸모가 있기 때문이다.).

따라서, f: a->b 는 a를 향하는 화살표를 b로 향하는 화살표에 매핑하는 화살표 매핑 $(f \circ - )$를 유도한다.

대상들이 내부적인 구조를 가지고 있지 않기 때문에, 우리는 f는 a를 b로 변환한다고 말할 수 있다.
후합성은, 우리가 한 대상에서 다른 대상으로의 집중을 옮길 수 있게 한다. 
이와 쌍을 이루는 개념으로, f를 전합성할 수 있다 $( - \circ f )$. 이는 b에서 출발하는 화살표를 a에서 출발하는 화살표로의 매핑을 의미한다. 전합성은 우리의 관점을 한 관찰자에서 다른 관찰자로 옮기게 한다. 

전/후합성은 화살표들의 사상이다. 이 화살표들은 집합을 이루므로, 이들은 집합들 사이의 함수들이다.

전/후합성을 바라보는 다른 관점으로는, 이들은 모두 합성 연산자 $ ( - \circ - ) $ 의 부분 적용된 결과인 것이다.

프로그래밍에서는, 나가는 화살표는 원천으로부터 추출한 데이터로 표현된다. 들어오는 화살표는 대상을 구성하거나, 생산하는 것으로 표현된다. 나가는 화살표는 인터페이스를 정의하고, 들어오는 화살표는 생성자를 정의한다. 

> 문제 2.1.1
> 다음의 두 화살표, f:a->b, b:b->c 가 있다.그들의 결합 $g \circ f$는 화살표 $((g \circ f) \circ -)$들의 사상을 도출한다. $(f \circ - )$ 를 먼저 적용하고, $( g \circ - )$ 를 적용한 것과 결과가 같다는 것을 증명하라. 기호적으로는, 
 $$((g \circ f) \circ -) = (g \circ -) \circ (f \circ -) $$
> 힌트: 임의의 대상 x를 골라, h:x->a를 만들고, 결과가 같은지 보라.

> -> 대상 x와 h:x->a 가 있을 때, 좌변의 함수에 h를 적용하게 되면, $(b->c \circ a ->b) \circ x->a$ 이다. 이 경우, 이의 결과는 $(a->c) \circ x->a$ 와 같고, 이는 x->c와 같다.
> -> 우변의 함수는 $(g \circ (f \circ - ))$ 이고, 이와 함수 h를 결합하면, $(b->c \circ (a->b \circ x->a )) $ 이다. 이는, $(b->c \circ x->b)$ 이고, 이는 $x->c와 같다.$
>
> 따라서 양변의 식에 h:x->a를 적용하였을 때에 x->c와 모두 같다.

## 2.2 함수 적용

우리는 첫 프로그램을 만들 준비가 되었다. "천릿길도 한걸음부터" 라는 말이 있듯, 우리의 여정은 1에서 b로 향하는 것부터 시작한다. 첫 단계는 끝 대상 1에서 a를 만드는 것이다. 이는 원소 a 이다. 

$$ 1 \xrightarrow{x} a $$

이후의 여정은

$$ a \xrightarrow{f} b $$

이 두 화살표는 합성 가능하고(둘 다 a를 공유한다) 그들의 합성은 1 to b인 y이다. 

우리는 이를 $y = f \circ x$ 와 같이 쓸 수 있다. 이를 함수 f에 x를 적용했다 하고, $\circ$는 생략할 수도 있다.

$$ y = fx $$

이를 하스켈로 옮겨보자. 

```haskell
x::a
f::a->b
y::b
y = f x
```

## 2.3 항등

함수는 바꾸는 것이 아니다. 바꾼다는 것은 이의 쌍을 가진다: 무위(無為)
모든 대상은 항등이라는 특수한 화살표를 가진다. 

$id_b \circ f = f = f \circ id_a$

시작과 끝 대상에서 자기 자신으로 향하는 화살표의 이름은 사실 id 이다.
논리학에서는 이를 항진식이라고 한다. 이는, a가 참이면, a가 참이다(펀쿨섹).

이런 항등함수는 일련의 함수들이 원점으로 돌아온다는 것을 검증할 때에 비교할 대상으로 사용될 수 있다. 

> 문제 2.3.1 $(id_a \circ - )$ 와 a로 끝나는 함수의 결과는 무엇인가?  (- \circ id_a) 와 a에서 출발하는 함수의 합성 결과는 무엇인가?
>
> 1 -> x 이고, x->a 가 있을때, $(a->a \circ x->a)$ 는 x->a 와 같다.
> a -> () 가 있을 때, $(a->() \circ a->a)$ 는 a->() 와 같다. 
>
> 즉, 항등사상 $id_a$에 적용되는(-) 자리에 들어가는 대상과 동일하다.